# Тестовое задание от Лаборатории Касперского

## Задача
Выполнить оценку работы библиотеки по извлечению текста новости. Необходимо определить полноту извлекаемого текста и оценить значимость тех частей текста, которые выделить не удалось. Проанализировать и предложить изменения в алгоритм работы библиотеки.

## Желаемый результат
Заполненная таблицa:
- с эталоном текста для каждой новости;
- с результатами оценки полноты (сравнения эталона текста и текста, извлеченного библиотекой);
- оценка значимости текста, который выделить не удалось;
комментарии, если есть предложения по улучшению.

Срок выполнения – неделя.

---

## Описание файлов

* `report_news.xlsl` : итоговая таблица с эталонным текстом и оценкой полноты
* `analysis_news.ipynb` : как была получена таблица (процессинг данных, количественная оценка схожести текстов, анализ результатов (что имено повлияло на метрики))
* `Test_check.xlsx` : исходный файл (url на новость и извлечнный текст новости)
* `utilits.py` : файл, где собраны функции, которые я использовала (в какой-то момент их стало много и стало неудобно читать основной ipynb)

## Выводы (как я к этому пришла описано в `analysis_news.ipynb`, я тут это просто дублирую)

### 1.  Как ведёт себя качество (ROUGE‑L\_f)

* Чем выше `precision (p)` и `recall (r)`, тем выше ROUGE, что логично.  
* ROUGE сильно падает, если растут  
  * `missing_cnt` – пропущенные предложения  
  * `lost_title_cnt` – пропущенные заголовки  
  * `lost_vrezka_cnt` – пропущенные «врезки»  
  * чуть слабее влияет `extra_cnt` – лишние фразы

### 2.  Что именно чаще теряется

* Больше всего пропусков – обычный текст (`lost_body_cnt`).  
* Но даже один пропущенный заголовок или врезка портит ROUGE почти так же, как десяток пропущенных обычных предложений. Эти блоки «весят» больше.

### 3.  Как связаны метрики друг с другом

| Пара метрик | Наблюдение |
|-------------|------------|
| `f1`, `jaccard`, `rougeL_f` | Почти одинаково реагируют на ошибки (корреляция ≈ 0.9). |
| `precision` ↔ `extra_cnt`  | `precision` остаётся высокой – «лишних» фраз мало. |
| `missing_cnt` ↔ `rougeL_f` | Самая сильная отрицательная связь: меньше пропусков → выше ROUGE. |

### 4.  Что можно сделать

1. Сократить пропуски (`missing_cnt`), особенно заголовков и врезок. Это самый быстрый способ поднять ROUGE.
2. Функция хорошо уьирает «лишнее» (высокий `precision`), поэтому сначала стоит научить ее находить больше нужных предложений, а не ужимать вывод.
3. `f1` и `jaccard` дублируют ROUGE‑L. Для отчётов можно оставить сам ROUGE‑L и счётчики пропусков/лишнего.
4. Отдельно стоит изучить сайты с большим количеством статей и низким средним ROUGE – именно они тянут итоговый результат вниз.

### 5.  Дальнейшие шаги

1. Проверить, почему теряются заголовки/врезки – возможно, они обособлены тегами или идут с необычной пунктуацией.  
2. Улучшить правила/модель извлечения для этих блоков.  
3. После фикса – пересчитать метрики и убедиться, что `missing_cnt` идет вниз,а ROUGE растет.
